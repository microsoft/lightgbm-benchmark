# to execute, run from /pipelines/azureml/
# > python pipelines/lightgbm_inferencing.py --config-dir ./conf --config-name experiments/benchmarks/lightgbm-inferencing run.submit=True

defaults:
  - aml: sample
  - compute: sample
  - modules: benchmark

# run parameters are command line arguments for running your experiment
run: # params for running pipeline
  experiment_name: "benchmark-lightgbm-inferencing" # IMPORTANT
  regenerate_outputs: false
  continue_on_failure: false
  verbose: false
  submit: false
  resume: false
  canary: false
  silent: false
  wait: false

module_loader: # module loading params
  use_local: "*"
  force_default_module_version: null
  force_all_module_version: null
  local_steps_folder: "../../../../../src/scripts/"

### CUSTOM PARAMETERS ###

lightgbm_inferencing:
  # name of your particular benchmark
  benchmark_name: "benchmark-inferencing-20211029" # need to be provided at runtime!

  tasks:
    - data:
        name: "data-synthetic-regression-10cols-10000samples-inference"
      model:
        name: "model-synthetic-regression-10cols-10trees-31leaves"
    - data:
        name: "data-synthetic-regression-10cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-10cols-100trees-31leaves"
    - data:
        name: "data-synthetic-regression-10cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-10cols-1000trees-31leaves"
    - data:
        name: "data-synthetic-regression-10cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-10cols-5000trees-31leaves"
    - data:
        name: "data-synthetic-regression-100cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-100cols-10trees-31leaves"
    - data:
        name: "data-synthetic-regression-100cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-100cols-100trees-31leaves"
    - data:
        name: "data-synthetic-regression-100cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-100cols-1000trees-31leaves"
    - data:
        name: "data-synthetic-regression-100cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-100cols-5000trees-31leaves"
    - data:
        name: "data-synthetic-regression-1000cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-1000cols-10trees-31leaves"
    - data:
        name: "data-synthetic-regression-1000cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-1000cols-100trees-31leaves"
    - data:
        name: "data-synthetic-regression-1000cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-1000cols-1000trees-31leaves"
    - data:
        name: "data-synthetic-regression-1000cols-10000samples-inference"
      model:
        name:  "model-synthetic-regression-1000cols-5000trees-31leaves"

  variants:
    - framework: lightgbm_python # v3.3.0 via pypi
    - framework: lightgbm_python # v3.2.1 via pypi
      build: docker/lightgbm-v3.2.1/linux_cpu_mpi_pip.dockerfile
      os: "Linux" # 'Linux' or 'Windows', linux is default
    - framework: lightgbm_python # v3.2.1 via build
      build: docker/lightgbm-v3.2.1/linux_cpu_mpi_build.dockerfile
      os: "Linux" # 'Linux' or 'Windows', linux is default
    - framework: lightgbm_python # v3.2.1 modified
      build: docker/lightgbm-custom/v321_patch_cpu_mpi_build.dockerfile
      os: "Linux" # 'Linux' or 'Windows', linux is default
    - framework: lightgbm_c_api # v3.3.0 with C API prediction
    - framework: treelite_python # v1.3.0
